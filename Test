Public Class frmMain

    Private Sub btnExit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnExit.Click
        Me.Close()
    End Sub

    Private Sub txtPrincipal_Enter(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtPrincipal.Enter
        txtPrincipal.SelectAll()
    End Sub

    Private Sub txtPrincipal_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles txtPrincipal.KeyPress
        ' accepts only numbers, the period, and the Backspace key

        If (e.KeyChar < "0" OrElse e.KeyChar > "9") AndAlso
            e.KeyChar <> "." AndAlso
            e.KeyChar <> ControlChars.Back Then
            e.Handled = True
        End If
    End Sub

    Private Sub txtPrincipal_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtPrincipal.TextChanged
        lblPayments.Text = String.Empty
    End Sub

    Private Sub btnCalc_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCalc.Click
        ' calculates the monthly payments on a loan
        ' using a term of 5 years and interest rates of 5% through 10%

        Const intTERM As Integer = 5
        Dim dblPrincipal As Double
        Dim dblPayment As Double
        Dim dblRate As Double = 0.05

        lblPayments.Text = String.Empty
        Double.TryParse(txtPrincipal.Text, dblPrincipal)

        ' calculate and display payments

        Do While dblRate < 0.1
            dblPayment =
                -Financial.Pmt(dblRate / 12, intTERM * 12, dblPrincipal)
            lblPayments.Text = lblPayments.Text &
                dblRate.ToString("P0") & " -> " &
                dblPayment.ToString("C2") & ControlChars.NewLine
            dblRate = dblRate + 0.01
        Loop

        txtPrincipal.Focus()
        txtPrincipal.SelectAll()
    End Sub

End Class

